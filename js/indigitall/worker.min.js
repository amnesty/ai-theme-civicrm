/*! For license information please see worker.min.js.LICENSE.txt */
!function(t,e){if("object"==typeof exports&&"object"==typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var r=e();for(var n in r)("object"==typeof exports?exports:t)[n]=r[n]}}(this,(()=>(()=>{var t={710:function(t){var e;e=()=>(()=>{"use strict";var t={330:t=>{t.exports=JSON.parse('{"name":"indigitall-web-core","description":"indigitall web core","version":"4.7.0","main":"index.js","author":"Smart2me S.L.","homepage":"https://indigitall.com","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"scripts":{"test":"echo \'There are not tests\'","public":"ws --directory ./public --port 80 --log.format dev","build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build"}}')}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n](o,o.exports,r),o.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{default:()=>j});var i={};r.r(i),r.d(i,{BaseClient:()=>T,BaseRequest:()=>b});var o={};r.r(o),r.d(o,{Channel:()=>R,Device:()=>P,DeviceStatus:()=>O,ErrorDictionary:()=>S,ErrorModel:()=>I,EventType:()=>w,TopicSubscribeType:()=>A});var s={};r.r(s),r.d(s,{CommonUtils:()=>N,CorePermissions:()=>L,CryptoUtils:()=>U,ErrorUtils:()=>_,JsonUtils:()=>k,Log:()=>m,LogLevel:()=>y,TopicUtils:()=>x,Validations:()=>M});var a={platform:"webpush",version:"0.0.1"};const c=r(330);a.version=c.version;const u=a=Object.assign(a,{client:{URL_BASE:"https://device-api.indigitall.com/v1",URL_DEVICE_V2:"https://device-api.indigitall.com/v2",INAPP_URL_BASE:"https://inapp-api.indigitall.com/v1",INBOX_URL_BASE:"https://inbox-api.indigitall.com/v1",CUSTOMER_URL_BASE:"https://device-api.indigitall.com/v2"}}),l=new class{constructor(){this.storage=this.isLocalStorageAvailable()?window.localStorage:null}isLocalStorageAvailable(){try{const t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==l.length}return!1}setItem(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}getItem(t){return null!=this.storage?this.storage.getItem(t):null}deleteItem(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}clear(){this.storage&&this.storage.clear()}},h=l,f=new class{constructor(){this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB}async getDB(){return new Promise(((t,e)=>{const r=this.IDB;if(r){const n=r.open("indigitall.indexedDB",1);n.onupgradeneeded=function(){n.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},n.onsuccess=function(){const e=n.result,r=e.transaction("indigitallStore","readwrite"),i=r.objectStore("indigitallStore"),o=i.index("storeIndex");t({db:e,tx:r,store:i,index:o})},n.onerror=function(t){e(t)}}else e(!1)}))}async get(t,e){return new Promise(((r,n)=>{t||n(!1),t.index.get(e).onsuccess=e=>{e.target.result&&(this.close(t),r(e.target.result.store.value)),n(!1)}}))}async put(t,e,r){return new Promise(((n,i)=>{t||i(!1),t.store.put({store:{key:e,value:r}},e).onsuccess=e=>{this.close(t),n(r)}}))}close(t){if(t.tx)try{t.tx.oncomplete=()=>{t.db.close()}}catch(t){console.error(this.TAG,t)}}async setItem(t,e){try{const r=await this.getDB();return this.put(r,t,e)}catch(t){return t}}async getItem(t){try{const e=await this.getDB();return this.get(e,t)}catch(t){return t}}},p=new class{constructor(){this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null}isSessionStorageAvailable(){try{const t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==p.length}return!1}getItem(t){return null!=this.session?this.session.getItem(t):null}setItem(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}clearMessages(){this.session&&this.session.removeItem("messages")}},d=p,E=class{constructor(){this.storage=h,this.db=f,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE",this.TOPIC_LIST=this.REPOSITORY+".TOPIC_LIST",this.INAPP_ENABLED=this.REPOSITORY+".INAPP_ENABLED",this.URL_INAPP_API=this.REPOSITORY+".URL_INAPP_API",this.INAPP_TOPICS=this.REPOSITORY+".INAPP_TOPICS",this.AVOID_CYPHER=this.REPOSITORY+".AVOID_CYPHER",this.URL_DEVICE_API=this.REPOSITORY+".URL_DEVICE_API"}setItemSessionStorage(t,e){d.setItem(t,e)}getItemSessionStorage(t){return d.getItem(t)}clearSessionStorage(){d.clearMessages()}setStorage(t,e){h.setItem(t,e)}getStorage(t){return h.getItem(t)}clearStorage(){h.clear()}setBrowserPublicKey(t){h.setItem(this.BROWSER_PUBLIC_KEY,t)}getBrowserPublicKey(){return h.getItem(this.BROWSER_PUBLIC_KEY)}setBrowserPrivateKey(t){h.setItem(this.BROWSER_PRIVATE_KEY,t)}getBrowserPrivateKey(){return h.getItem(this.BROWSER_PRIVATE_KEY)}async setAppKey(t){h.setItem(this.APP_KEY,t),f&&f.IDB&&await f.setItem(this.APP_KEY,t)}getAppKey(){return h.getItem(this.APP_KEY)}async getAppKeySync(){if(f&&f.IDB)return await f.getItem(this.APP_KEY)}setVAPID(t){h.setItem(this.VAPID_PUBLIC,t)}getVAPID(){return h.getItem(this.VAPID_PUBLIC)}setEnabled(t){h.setItem(this.ENABLED,t)}getEnabled(){return h.getItem(this.ENABLED)}setServiceSyncTime(t){h.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}getServiceSyncTime(){return h.getItem(this.SERVICE_SYNC_TIME)||1*this.BASE_TIME}setLocationEnabled(t){h.setItem(this.LOCATION_ENABLED,t)}getLocationEnabled(){return h.getItem(this.LOCATION_ENABLED)}setLocationUpdateMinutes(t){h.setItem(this.LOCATION_UPDATE_MINUTES,t)}getLocationUpdateMinutes(){return h.getItem(this.LOCATION_UPDATE_MINUTES)||30}async setRequestLocation(t){h.setItem(this.REQUEST_LOCATION,t)}getRequestLocation(){return!!h&&h.getItem(this.REQUEST_LOCATION)}async setPlatform(t){h.setItem(this.PLATFORM,t)}getPlatform(){return h&&h.getItem(this.PLATFORM)||u.platform}getVersion(){return u.version}async setBrowserName(t){h.setItem(this.BROWSER_NAME,t)}getBrowserName(){return h.getItem(this.BROWSER_NAME)}setBrowserVersion(t){h.setItem(this.BROWSER_VERSION,t)}getBrowserVersion(){return h.getItem(this.BROWSER_VERSION)}async setOsName(t){h.setItem(this.OS_NAME,t)}getOsName(){return h.getItem(this.OS_NAME)}setOsVersion(t){h.setItem(this.OS_VERSION,t)}getOsVersion(){return h.getItem(this.OS_VERSION)}setDeviceType(t){h.setItem(this.DEVICE_TYPE,t)}getDeviceType(){return h.getItem(this.DEVICE_TYPE)}setSupported(t){h.setItem(this.SUPPORTED,t)}getSupported(){return h.getItem(this.SUPPORTED)}setServiceTimestamp(t){h.setItem(this.SERVICE_TIMESTAMP,t)}getServiceTimestamp(){return h.getItem(this.SERVICE_TIMESTAMP)}setLocationTimestamp(t){h.setItem(this.LOCATION_TIMESTAMP,t)}getLocationTimestamp(){return h.getItem(this.LOCATION_TIMESTAMP)}setPermissionLocation(t){h.setItem(this.PERMISSION_LOCATION,t)}getPermissionLocation(){return h.getItem(this.PERMISSION_LOCATION)}setDebugLog(t){h.setItem(this.SET_LOG_DEBUG,t)}getDebugLog(){return"false"!==h.getItem(this.SET_LOG_DEBUG)}setLogLevel(t){h.setItem(this.LOG_LEVEL,t)}getLogLevel(){return h.getItem(this.LOG_LEVEL)}setNewUserTimestamp(t){h.setItem(this.NEW_USER_TIMESTAMP,t)}getNewUserTimestamp(){return h.getItem(this.NEW_USER_TIMESTAMP)}async setExternalIdRequest(t){h&&h.isLocalStorageAvailable()&&h.setItem(this.EXTERNAL_ID,t),f&&f.IDB&&await f.setItem(this.EXTERNAL_ID,t)}async getExternalIdRequest(){let t;try{h&&h.isLocalStorageAvailable()?t=h.getItem(this.EXTERNAL_ID):f&&f.IDB&&(t=await f.getItem(this.EXTERNAL_ID))}catch(t){}return t}setExternalId(t){h.setItem(this.EXTERNAL_ID,t)}getExternalId(){return h.getItem(this.EXTERNAL_ID)}async getRegisteredByCookie(){return h.getItem(this.REGISTERED_BY_COOKIE)}async setRegisteredByCookie(t){h.setItem(this.REGISTERED_BY_COOKIE,t)}setLatitude(t){h.setItem(this.LATITUDE,t)}getLatitude(){return h.getItem(this.LATITUDE)}setLongitude(t){h.setItem(this.LONGITUDE,t)}getLongitude(){return h.getItem(this.LONGITUDE)}async setInAppTopicList(t){this.db&&this.db.IDB&&await this.db.setItem(this.INAPP_TOPICS,t)}async getInAppTopicList(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.INAPP_TOPICS))}catch(t){}return t}async setTopicList(t){this.db&&this.db.IDB&&await this.db.setItem(this.TOPIC_LIST,t)}async getTopicList(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.TOPIC_LIST))}catch(t){}return t}getUrlInappApi(){return this.getStorage(this.URL_INAPP_API)}setUrlInappApi(t){this.setStorage(this.URL_INAPP_API,t)}setInAppEnabled(t){this.setStorage(this.INAPP_ENABLED,t)}isInAppEnabled(){return this.getStorage(this.INAPP_ENABLED)}setAvoidCypher(t){this.setStorage(this.AVOID_CYPHER,t)}isAvoidCypher(){return this.getStorage(this.AVOID_CYPHER)}async getUrlDeviceApi(){let t;try{this.storage&&this.storage.isLocalStorageAvailable()?t=this.getStorage(this.URL_DEVICE_API):this.db&&this.db.IDB&&(t=await this.db.getItem(this.URL_DEVICE_API))}catch(t){}return t}async setUrlDeviceApi(t){this.storage&&this.storage.isLocalStorageAvailable()&&this.setStorage(this.URL_DEVICE_API,t),this.db&&this.db.IDB&&await this.db.setItem(this.URL_DEVICE_API,t)}},y=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4}),v=y;class g{constructor(t){this.tag="[IND]",t&&(this.tag=t),this.level=v.INFO,this.setLogLevel((new E).getLogLevel()),this.log=[]}setLogLevel(t){t&&t>=v.DEBUG&&t<=v.ERROR&&(this.level=t)}static addedAsString(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}d(){if(this.level<=v.DEBUG)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}i(){if(this.level<=v.INFO)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}w(){if(this.level<=v.WARNING)for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}e(){if(this.level<=v.ERROR)if(1==arguments.length&&arguments.errorCode)this.log+=`${error.errorCode}: ${error.errorMessage}`;else for(let t=0;t<arguments.length;t++)this.log+=g.addedAsString(arguments[t]);return this}writeLog(){this.log.length>0&&this.tag&&this.log&&console.log(this.tag,this.log),this.log=[]}}const m=g,I=class{constructor(t,e,r){this.errorCode=t,this.errorMessage=e,null!=r&&(this.exceptionMessage=r)}},_=new class{constructor(){}showError(t,e,r){if(null!=t){const n=Object.values(t.ErrorCode).indexOf(e);return n>=0?new I(Object.keys(t.ErrorCode)[n],Object.keys(t.ErrorMessage)[n],r):new I(GENERAL_ERROR,"general error",r)}}},S={ErrorCode:{GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410},ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}},T=class{constructor(){this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"}async getURL(){return this.URL_BASE}async call(t,e,r,n){const i=new m("[IND]BaseClient: ");r.isServiceWorkerRequest()&&i.setLogLevel(v.DEBUG);let o=await this.getURL()+r.getPath(e)+r.getParams();r.isJourneyRequest()&&(o=o.replace("v1","v2"));const s={method:t,headers:r.addHeaders()};t!==this.GET&&(s.body=JSON.stringify(r.getBody())),n&&(s.credentials=n);try{const e=await fetch(o,s),n=await e.json();return e.ok?(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(r.getBody(),null,"\t")+"\n":"")+"Response Code: "+n.statusCode+"\nResponse Message: "+n.message+"\nResponse Body:",JSON.stringify(n.data,null,"\t")).writeLog(),n):(i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(r.getBody(),null,"\t")+"\n":"")+"Response Code: "+n.statusCode+"\nResponse Message: "+n.message+"\n").writeLog(),new I(n.statusCode,n.message))}catch(e){return i.d("Method: "+t+"\nURL: "+o+"\n"+(t!==this.GET?"Request Body: "+JSON.stringify(r.getBody(),null,"\t")+"\n":"")+"Error: "+e).writeLog(),_.showError(S,S.ErrorCode.GENERAL_ERROR,e)}}async get(t,e){return await this.call(this.GET,t,e)}async post(t,e,r){return await this.call(this.POST,t,e,r)}async put(t,e,r){return await this.call(this.PUT,t,e,r)}async delete(t,e){return await this.call(this.DELETE,t,e)}},b=class{constructor(){this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new E).getAppKey(),this.params=null,this.pathParams={},this.headers={}}getParams(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}getBody(){return this.body?this.body:""}getPath(t){let e=t;return Object.keys(this.pathParams).forEach((t=>{e=e.replace(t,this.pathParams[t])})),e}addHeaders(){const t=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((e=>{t.append(e,this.headers[e])})),t}isServiceWorkerRequest(){return this.serviceWorkerRequest}setServiceWorkerRequest(t){this.serviceWorkerRequest=t}isJourneyRequest(){return this.journeyRequest}setJourneyRequest(t){this.journeyRequest=t}},R=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"}),P=class{constructor(t=null,e){null==t?(this.browserPublicKey=(new E).getBrowserPublicKey(),this.browserPrivateKey=(new E).getBrowserPrivateKey(),this.platform=(new E).getPlatform(),this.version=(new E).getVersion(),this.browserName=(new E).getBrowserName(),this.browserVersion=(new E).getBrowserVersion(),this.osName=(new E).getOsName(),this.osVersion=(new E).getOsVersion(),this.deviceType=(new E).getDeviceType(),(new E).getEnabled()&&(this.enabled="true"===(new E).getEnabled()),(new E).getExternalId()&&(this.externalCode=(new E).getExternalId())):e?(t.enabled&&(this.enabled=t.enabled,(new E).setEnabled(this.enabled)),t.registeredByCookie&&(this.registeredByCookie=t.registeredByCookie,(new E).setRegisteredByCookie(this.registeredByCookie))):(t.browserPublicKey&&(this.browserPublicKey=t.browserPublicKey),t.browserPrivateKey&&(this.browserPrivateKey=t.browserPrivateKey),t.platform&&(this.platform=t.platform),t.version&&(this.version=t.version),t.osVersion&&(this.osVersion=t.osVersion),t.browserName&&(this.browserName=t.browserName),t.browserVersion&&(this.browserVersion=t.browserVersion),t.osName&&(this.osName=t.osName),t.deviceType&&(this.deviceType=t.deviceType),t.enabled&&(this.enabled=t.enabled),t.externalCode&&(this.externalCode=t.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}getDeviceId(){return this.deviceId}setDeviceId(t){this.deviceId=t}setExternalCode(t){this.externalCode=t}toJSON(){const t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}},O=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0}),w=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"}),A=Object.freeze({SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe"}),N=class{static isServiceTimestampExceed(){return!(new E).getServiceTimestamp()||(new E).getServiceSyncTime()<=(Date.now()-(new E).getServiceTimestamp())/6e4}static isFunction(t){return!(!t||"function"!=typeof t)}},L=class{static async getPermissions(){const t=await this.getPermission("geolocation"),e={};return t&&(e.location=t.state),e}static async getPermission(t){try{if(navigator&&navigator.permissions&&navigator.permissions.query&&t)return await navigator.permissions.query({name:t,userVisibleOnly:!0})}catch(t){return null}return null}static async setPermissionsCallback(){await this.setCallback("geolocation",navigator.indigitallRequestLocationPermission)}static async setCallback(t,e){const r=await this.getPermission(t);if(r){let n=r.state;"onchange"in r&&(r.onchange=()=>{new m("[IND]CorePermissions: ").d(t+" permission state has changed from "+n+" to "+r.state).writeLog(),n=r.state,e&&e({name:t,state:r.state})})}}},C=new m("[IND]Crypto"),D=new TextEncoder("utf-8"),B="HMAC",U=class{static async createHmac(t,e){try{let r="";if(!0===(new E).isAvoidCypher())r=e;else{const n=window?.crypto?.subtle;if(!n)return;const i=await n.importKey("raw",D.encode(t),{name:B,hash:{name:"SHA-256"}},!1,["sign","verify"]),o=await n.sign(B,i,D.encode(e)),s=new Uint8Array(o);r=Array.prototype.map.call(s,(t=>("00"+t.toString(16)).slice(-2))).join(""),C.d("hmac: ",r).writeLog()}return r}catch(t){return void C.e("error:",t).writeLog()}}},k=class{static compareJSON(t,e){const r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(const n of r)if(t[n]!==e[n]){if("object"!=typeof t[n]||"object"!=typeof e[n])return!1;if(!isEqual(t[n],e[n]))return!1}return!0}},M=class{static isValidFormat(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}},x=class{static setTopicChannel(t,e){const r=[];for(let n=0;n<t.length;n++){const i=t[n];i.channel=e,r.push(i)}return r}},j={Repository:E,Config:u,Api:i,Models:o,Utils:s};return n})(),t.exports=e()},315:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0});var i={Core:!0};Object.defineProperty(e,"Core",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"default",{enumerable:!0,get:function(){return o.default}});var o=function(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=n(t)&&"function"!=typeof t)return{default:t};var r=c(e);if(r&&r.has(t))return r.get(t);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&{}.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}(r(710));Object.keys(o).forEach((function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(i,t)||t in e&&e[t]===o[t]||Object.defineProperty(e,t,{enumerable:!0,get:function(){return o[t]}}))}));var s,a=(s=r(610))&&s.__esModule?s:{default:s};function c(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(c=function(t){return t?r:e})(t)}},468:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(r(254)),i=c(r(234)),o=c(r(457)),s=c(r(735)),a=c(r(630));function c(t){return t&&t.__esModule?t:{default:t}}function u(t){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},u(t)}function l(){l=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,s=Object.create(o.prototype),a=new C(n||[]);return i(s,"_invoke",{value:w(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",E="suspendedYield",y="executing",v="completed",g={};function m(){}function I(){}function _(){}var S={};h(S,s,(function(){return this}));var T=Object.getPrototypeOf,b=T&&T(T(D([])));b&&b!==r&&n.call(b,s)&&(S=b);var R=_.prototype=m.prototype=Object.create(S);function P(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(i,o,s,a){var c=p(t[i],t,o);if("throw"!==c.type){var l=c.arg,h=l.value;return h&&"object"==u(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,a)}))}a(c.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function w(e,r,n){var i=d;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var u=p(e,r,n);if("normal"===u.type){if(i=n.done?v:E,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(u(e)+" is not iterable")}return I.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:I,configurable:!0}),I.displayName=h(_,c,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===I||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,c,"GeneratorFunction")),t.prototype=Object.create(R),t},e.awrap=function(t){return{__await:t}},P(O.prototype),h(O.prototype,a,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new O(f(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(R),h(R,c,"Generator"),h(R,s,(function(){return this})),h(R,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function h(t,e,r,n,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function f(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){h(o,n,i,s,a,"next",t)}function a(t){h(o,n,i,s,a,"throw",t)}s(void 0)}))}}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,d(n.key),n)}}function d(t){var e=function(t,e){if("object"!=u(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=u(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==u(e)?e:e+""}var E=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.URL_BASE="",this.GET="GET",this.POST="POST",this.PUT="PUT",this.DELETE="DELETE"},e=[{key:"getURL",value:(y=f(l().mark((function t(){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",this.URL_BASE);case 1:case"end":return t.stop()}}),t,this)}))),function(){return y.apply(this,arguments)})},{key:"call",value:(E=f(l().mark((function t(e,r,c,u){var h,f,p,d,E;return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return h=new n.default("[IND]BaseClient: "),c.isServiceWorkerRequest()&&h.setLogLevel(a.default.DEBUG),t.next=4,this.getURL();case 4:return t.t0=t.sent,t.t1=c.getPath(r),t.t2=t.t0+t.t1,t.t3=c.getParams(),f=t.t2+t.t3,c.isJourneyRequest()&&(f=f.replace("v1","v2")),p={method:e,headers:c.addHeaders()},e!==this.GET&&(p.body=JSON.stringify(c.getBody())),u&&(p.credentials=u),t.prev=13,t.next=16,fetch(f,p);case 16:return d=t.sent,t.next=19,d.json();case 19:if(E=t.sent,!d.ok){t.next=23;break}return h.d("Method: "+e+"\nURL: "+f+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(c.getBody(),null,"\t")+"\n":"")+"Response Code: "+E.statusCode+"\nResponse Message: "+E.message+"\nResponse Body:",JSON.stringify(E.data,null,"\t")).writeLog(),t.abrupt("return",E);case 23:return h.d("Method: "+e+"\nURL: "+f+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(c.getBody(),null,"\t")+"\n":"")+"Response Code: "+E.statusCode+"\nResponse Message: "+E.message+"\n").writeLog(),t.abrupt("return",new i.default(E.statusCode,E.message));case 27:return t.prev=27,t.t4=t.catch(13),h.d("Method: "+e+"\nURL: "+f+"\n"+"".concat(e!==this.GET?"Request Body: "+JSON.stringify(c.getBody(),null,"\t")+"\n":"")+"Error: "+t.t4).writeLog(),t.abrupt("return",o.default.showError(s.default,s.default.ErrorCode.GENERAL_ERROR,t.t4));case 31:case"end":return t.stop()}}),t,this,[[13,27]])}))),function(t,e,r,n){return E.apply(this,arguments)})},{key:"get",value:(d=f(l().mark((function t(e,r){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.GET,e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return d.apply(this,arguments)})},{key:"post",value:(h=f(l().mark((function t(e,r,n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.POST,e,r,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return h.apply(this,arguments)})},{key:"put",value:(u=f(l().mark((function t(e,r,n){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.PUT,e,r,n);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e,r){return u.apply(this,arguments)})},{key:"delete",value:(c=f(l().mark((function t(e,r){return l().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.call(this.DELETE,e,r);case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t,this)}))),function(t,e){return c.apply(this,arguments)})}],e&&p(t.prototype,e),r&&p(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,c,u,h,d,E,y}();e.default=E},23:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(291))&&n.__esModule?n:{default:n};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c=function(){return function(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.PARAM_APP_KEY="appKey",this.PARAM_DEVICE_ID="deviceId",this.PARAM_PUSH_TOKEN="pushToken",this.PARAM_ENABLED="enabled",this.PARAM_PLATFORM="platform",this.PARAM_VERSION="version",this.PARAM_TOPICS="topics",this.PARAM_EVENT_TYPE="eventType",this.PARAM_PUSH_ID="pushId",this.PARAM_CLICKED_BUTTON="clickedButton",this.PARAM_PERMISSION_TYPE="permissionType",this.PARAM_LATITUDE="latitude",this.PARAM_LONGITUDE="longitude",this.PARAM_INAPP_ID="inAppId",this.PARAM_INAPP_EVENT_TYPE="eventType",this.PARAM_INAPP_CLICKED_BUTTON="clickedButton",this.PARAM_INAPP_LAST_VERSION_ID="lastVersionId",this.PARAM_INBOX_EXTERNALID="externalId",this.PARAM_INBOX_PAGE="page",this.PARAM_INBOX_PAGE_SIZE="pageSize",this.PARAM_INBOX_DATE_FROM="dateFrom",this.PARAM_INBOX_DATE_TO="dateTo",this.PARAM_INBOX_STATUS="status",this.PARAM_INBOX_SENDER_IDS="sendingIds",this.PARAM_CUSTOMER_ID="customerId",this.PARAM_CUSTOMER_FIELD_NAMES="fieldNames",this.PARAM_CUSTOMER_FIELDS="fields",this.PARAM_CUSTOMER_LINK="link",this.PARAM_CUSTOMER_CHANNEL="channel",this.appKey=(new i.default).getAppKey(),this.params=null,this.pathParams={},this.headers={}}),[{key:"getParams",value:function(){return"?"+this.PARAM_APP_KEY+"="+this.appKey+(this.params?"&"+this.params:"")}},{key:"getBody",value:function(){return this.body?this.body:""}},{key:"getPath",value:function(t){var e=this,r=t;return Object.keys(this.pathParams).forEach((function(t){r=r.replace(t,e.pathParams[t])})),r}},{key:"addHeaders",value:function(){var t=this,e=new Headers({"Content-Type":"application/json"});return Object.keys(this.headers).forEach((function(r){e.append(r,t.headers[r])})),e}},{key:"isServiceWorkerRequest",value:function(){return this.serviceWorkerRequest}},{key:"setServiceWorkerRequest",value:function(t){this.serviceWorkerRequest=t}},{key:"isJourneyRequest",value:function(){return this.journeyRequest}},{key:"setJourneyRequest",value:function(t){this.journeyRequest=t}}])}();e.default=c},545:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"BaseClient",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"BaseRequest",{enumerable:!0,get:function(){return i.default}});var n=o(r(468)),i=o(r(23));function o(t){return t&&t.__esModule?t:{default:t}}},122:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={platform:"webpush",version:"0.0.1"},i=r(904);n.version=i.version,n=Object.assign(n,{client:{URL_BASE:"https://".concat("","device-api.indigitall.com/v1"),URL_DEVICE_V2:"https://".concat("","device-api.indigitall.com/v2"),INAPP_URL_BASE:"https://".concat("","inapp-api.indigitall.com/v1"),INBOX_URL_BASE:"https://".concat("","inbox-api.indigitall.com/v1"),CUSTOMER_URL_BASE:"https://".concat("","device-api.indigitall.com/v2")}});e.default=n},610:(t,e,r)=>{"use strict";function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var i=h(r(122)),o=h(r(291)),s=l(r(545)),a=l(r(225)),c=l(r(628));function u(t){if("function"!=typeof WeakMap)return null;var e=new WeakMap,r=new WeakMap;return(u=function(t){return t?r:e})(t)}function l(t,e){if(!e&&t&&t.__esModule)return t;if(null===t||"object"!=n(t)&&"function"!=typeof t)return{default:t};var r=u(e);if(r&&r.has(t))return r.get(t);var i={__proto__:null},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var s in t)if("default"!==s&&{}.hasOwnProperty.call(t,s)){var a=o?Object.getOwnPropertyDescriptor(t,s):null;a&&(a.get||a.set)?Object.defineProperty(i,s,a):i[s]=t[s]}return i.default=t,r&&r.set(t,i),i}function h(t){return t&&t.__esModule?t:{default:t}}e.default={Repository:o.default,Config:i.default,Api:s,Models:a,Utils:c}},902:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.Channel=void 0;var r=e.Channel=Object.freeze({PUSH:"push",INAPP:"inapp",CHAT:"chat"});e.default=r},395:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(291))&&n.__esModule?n:{default:n};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c=function(){return function(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),null==e?(this.browserPublicKey=(new i.default).getBrowserPublicKey(),this.browserPrivateKey=(new i.default).getBrowserPrivateKey(),this.platform=(new i.default).getPlatform(),this.version=(new i.default).getVersion(),this.browserName=(new i.default).getBrowserName(),this.browserVersion=(new i.default).getBrowserVersion(),this.osName=(new i.default).getOsName(),this.osVersion=(new i.default).getOsVersion(),this.deviceType=(new i.default).getDeviceType(),(new i.default).getEnabled()&&(this.enabled="true"===(new i.default).getEnabled()),(new i.default).getExternalId()&&(this.externalCode=(new i.default).getExternalId())):r?(e.enabled&&(this.enabled=e.enabled,(new i.default).setEnabled(this.enabled)),e.registeredByCookie&&(this.registeredByCookie=e.registeredByCookie,(new i.default).setRegisteredByCookie(this.registeredByCookie))):(e.browserPublicKey&&(this.browserPublicKey=e.browserPublicKey),e.browserPrivateKey&&(this.browserPrivateKey=e.browserPrivateKey),e.platform&&(this.platform=e.platform),e.version&&(this.version=e.version),e.osVersion&&(this.osVersion=e.osVersion),e.browserName&&(this.browserName=e.browserName),e.browserVersion&&(this.browserVersion=e.browserVersion),e.osName&&(this.osName=e.osName),e.deviceType&&(this.deviceType=e.deviceType),e.enabled&&(this.enabled=e.enabled),e.externalCode&&(this.externalCode=e.externalCode)),this.platform&&(this.productName=this.platform),this.version&&(this.productVersion=this.version),navigator&&"language"in navigator&&(this.locale=navigator.language),Intl&&"DateTimeFormat"in Intl&&(this.timeZone=Intl.DateTimeFormat().resolvedOptions().timeZone),this.timeOffset=-(new Date).getTimezoneOffset()}),[{key:"getDeviceId",value:function(){return this.deviceId}},{key:"setDeviceId",value:function(t){this.deviceId=t}},{key:"setExternalCode",value:function(t){this.externalCode=t}},{key:"toJSON",value:function(){var t={};return this.platform&&(t.platform=this.platform),this.version&&(t.version=this.version),this.productName&&(t.productName=this.productName),this.productVersion&&(t.productVersion=this.productVersion),this.browserName&&(t.browserName=this.browserName),this.browserVersion&&(t.browserVersion=this.browserVersion),this.osName&&(t.osName=this.osName),this.osVersion&&(t.osVersion=this.osVersion),this.deviceType&&(t.deviceType=this.deviceType),this.locale&&(t.locale=this.locale),this.timeZone&&(t.timeZome=this.timeZone),this.timeOffset&&(t.timeOffset=this.timeOffset),this.enabled&&(t.enabled=this.enabled),this.browserPublicKey&&(t.browserPublicKey=this.browserPublicKey),this.browserPrivateKey&&(t.browserPrivateKey=this.browserPrivateKey),this.externalCode&&(t.externalCode=this.externalCode),t}}])}();e.default=c},89:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=Object.freeze({DEFAULT:-1,ENABLE:1,DISABLE:0});e.default=r},735:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r={GENERAL_ERROR:600,API_SERVER_ERROR:500,API_PARAMETER_MISSING:400,API_APPKEY_NOT_VALID:401,API_FORBIDDEN_REQUEST:403,API_DEVICE_NOT_FOUND:404,API_TOPICS_ARE_INSERTED:409,BAD_REQUEST_SERVER_ERROR:410};var n={ErrorCode:r,ErrorMessage:{GENERAL_ERROR:"General Error",API_SERVER_ERROR:"Error server response",API_PARAMETER_MISSING:"Api parameter missing",API_APPKEY_NOT_VALID:"appKey is not valid",API_FORBIDDEN_REQUEST:"forbidden request",API_DEVICE_NOT_FOUND:"device not found",API_TOPICS_ARE_INSERTED:"topics are inserted",BAD_REQUEST_SERVER_ERROR:"bad request"}};e.default=n},234:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,o(n.key),n)}}function i(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=i((function t(e,r,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.errorCode=e,this.errorMessage=r,null!=n&&(this.exceptionMessage=n)}));e.default=s},953:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=Object.freeze({EVENT_TYPE_CLICK:"click",EVENT_TYPE_RECEIVE:"receive",EVENT_TYPE_UPDATE:"update",EVENT_TYPE_ACCEPT:"accept",EVENT_TYPE_REJECT:"reject",EVENT_TYPE_ASK:"ask"});e.default=r},72:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=Object.freeze({SUBSCRIBE:"subscribe",UNSUBSCRIBE:"unsubscribe"});e.default=r},225:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"Channel",{enumerable:!0,get:function(){return n.Channel}}),Object.defineProperty(e,"Device",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"DeviceStatus",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorDictionary",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"ErrorModel",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"EventType",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"TopicSubscribeType",{enumerable:!0,get:function(){return u.default}});var n=r(902),i=l(r(395)),o=l(r(89)),s=l(r(735)),a=l(r(234)),c=l(r(953)),u=l(r(72));function l(t){return t&&t.__esModule?t:{default:t}}},672:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(){n=function(){return e};var t,e={},i=Object.prototype,o=i.hasOwnProperty,s=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,o=Object.create(i.prototype),a=new C(n||[]);return s(o,"_invoke",{value:w(t,r,a)}),o}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",E="suspendedYield",y="executing",v="completed",g={};function m(){}function I(){}function _(){}var S={};h(S,c,(function(){return this}));var T=Object.getPrototypeOf,b=T&&T(T(D([])));b&&b!==i&&o.call(b,c)&&(S=b);var R=_.prototype=m.prototype=Object.create(S);function P(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(i,s,a,c){var u=p(t[i],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==r(h)&&o.call(h,"__await")?e.resolve(h.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return n("throw",t,a,c)}))}c(u.arg)}var i;s(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,i){n(t,r,e,i)}))}return i=i?i.then(o,o):o()}})}function w(e,r,n){var i=d;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var u=p(e,r,n);if("normal"===u.type){if(i=n.done?v:E,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var n=e[c];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(r(e)+" is not iterable")}return I.prototype=_,s(R,"constructor",{value:_,configurable:!0}),s(_,"constructor",{value:I,configurable:!0}),I.displayName=h(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===I||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,l,"GeneratorFunction")),t.prototype=Object.create(R),t},e.awrap=function(t){return{__await:t}},P(O.prototype),h(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new O(f(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(R),h(R,l,"Generator"),h(R,c,(function(){return this})),h(R,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var i=this.tryEntries.length-1;i>=0;--i){var s=this.tryEntries[i],a=s.completion;if("root"===s.tryLoc)return n("end");if(s.tryLoc<=this.prev){var c=o.call(s,"catchLoc"),u=o.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return n(s.catchLoc,!0);if(this.prev<s.finallyLoc)return n(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return n(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return n(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var s=i?i.completion:{};return s.type=t,s.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function i(t,e,r,n,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function o(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var s=t.apply(e,r);function a(t){i(s,n,o,a,c,"next",t)}function c(t){i(s,n,o,a,c,"throw",t)}a(void 0)}))}}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.TAG="[IND]IndexedDB: ",this.DB_NAME="indigitall.indexedDB",this.DB_VERSION=1,this.DB_STORE_NAME="indigitallStore",this.DB_STORE_MODE="readwrite",this.DB_KEY_PATH="id",this.DB_STORE_INDEX="storeIndex",this.IDB=indexedDB||mozzIndexedDB||webkitIndexedDB||msIndexedDB},e=[{key:"getDB",value:(l=o(n().mark((function t(){var e=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,r){var n=e.IDB;if(n){var i=n.open("indigitall.indexedDB",1);i.onupgradeneeded=function(){i.result.createObjectStore("indigitallStore").createIndex("storeIndex","store.key")},i.onsuccess=function(){var e=i.result,r=e.transaction("indigitallStore","readwrite"),n=r.objectStore("indigitallStore"),o=n.index("storeIndex");t({db:e,tx:r,store:n,index:o})},i.onerror=function(t){r(t)}}else r(!1)})));case 1:case"end":return t.stop()}}),t)}))),function(){return l.apply(this,arguments)})},{key:"get",value:(u=o(n().mark((function t(e,r){var i=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e||n(!1),e.index.get(r).onsuccess=function(r){r.target.result&&(i.close(e),t(r.target.result.store.value)),n(!1)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e){return u.apply(this,arguments)})},{key:"put",value:(c=o(n().mark((function t(e,r,i){var o=this;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){e||n(!1),e.store.put({store:{key:r,value:i}},r).onsuccess=function(r){o.close(e),t(i)}})));case 1:case"end":return t.stop()}}),t)}))),function(t,e,r){return c.apply(this,arguments)})},{key:"close",value:function(t){if(t.tx)try{t.tx.oncomplete=function(){t.db.close()}}catch(t){console.error(this.TAG,t)}}},{key:"setItem",value:(a=o(n().mark((function t(e,r){var i;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return i=t.sent,t.abrupt("return",this.put(i,e,r));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t,e){return a.apply(this,arguments)})},{key:"getItem",value:(i=o(n().mark((function t(e){var r;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getDB();case 3:return r=t.sent,t.abrupt("return",this.get(r,e));case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",t.t0);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return i.apply(this,arguments)})}],e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i,a,c,u,l}();e.default=new c},87:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=this.isLocalStorageAvailable()?window.localStorage:null},e=[{key:"isLocalStorageAvailable",value:function(){try{var t=window.localStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==o.length}return!1}},{key:"setItem",value:function(t,e){return null!=this.storage&&(this.storage.setItem(t,e),!0)}},{key:"getItem",value:function(t){return null!=this.storage?this.storage.getItem(t):null}},{key:"deleteItem",value:function(t){return!!this.storage&&(this.storage.setItem(t,value),!0)}},{key:"clear",value:function(){this.storage&&this.storage.clear()}}],e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}());e.default=o},291:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=a(r(122)),i=a(r(87)),o=a(r(672)),s=a(r(238));function a(t){return t&&t.__esModule?t:{default:t}}function c(t){return c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},c(t)}function u(){u=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,s=Object.create(o.prototype),a=new C(n||[]);return i(s,"_invoke",{value:w(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",E="suspendedYield",y="executing",v="completed",g={};function m(){}function I(){}function _(){}var S={};h(S,s,(function(){return this}));var T=Object.getPrototypeOf,b=T&&T(T(D([])));b&&b!==r&&n.call(b,s)&&(S=b);var R=_.prototype=m.prototype=Object.create(S);function P(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(i,o,s,a){var u=p(t[i],t,o);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==c(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,s,a)}),(function(t){r("throw",t,s,a)})):e.resolve(h).then((function(t){l.value=t,s(l)}),(function(t){return r("throw",t,s,a)}))}a(u.arg)}var o;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return o=o?o.then(i,i):i()}})}function w(e,r,n){var i=d;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var u=p(e,r,n);if("normal"===u.type){if(i=n.done?v:E,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,o=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return o.next=o}}throw new TypeError(c(e)+" is not iterable")}return I.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:I,configurable:!0}),I.displayName=h(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===I||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,l,"GeneratorFunction")),t.prototype=Object.create(R),t},e.awrap=function(t){return{__await:t}},P(O.prototype),h(O.prototype,a,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new O(f(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(R),h(R,l,"Generator"),h(R,s,(function(){return this})),h(R,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function l(t,e,r,n,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function h(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){l(o,n,i,s,a,"next",t)}function a(t){l(o,n,i,s,a,"throw",t)}s(void 0)}))}}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,p(n.key),n)}}function p(t){var e=function(t,e){if("object"!=c(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=c(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==c(e)?e:e+""}var d=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.storage=i.default,this.db=o.default,this.BASE_TIME=60,this.REPOSITORY="indigitall.repository",this.APP_KEY=this.REPOSITORY+".APP_KEY",this.VAPID_PUBLIC=this.REPOSITORY+".VAPID_PUBLIC",this.ENABLED=this.REPOSITORY+".ENABLED",this.DEVICE_ID=this.REPOSITORY+".DEVICE_ID",this.SERVICE_SYNC_TIME=this.REPOSITORY+".SERVICE_SYNC_TIME",this.LOCATION_ENABLED=this.REPOSITORY+".LOCATION_ENABLED",this.LOCATION_UPDATE_MINUTES=this.REPOSITORY+".LOCATION_UPDATE_MINUTES",this.REQUEST_LOCATION=this.REPOSITORY+".REQUEST_LOCATION",this.BROWSER_PUBLIC_KEY=this.REPOSITORY+".BROWSER_PUBLIC_KEY",this.BROWSER_PRIVATE_KEY=this.REPOSITORY+".BROWSER_PRIVATE_KEY",this.PLATFORM=this.REPOSITORY+".PLATFORM",this.BROWSER_NAME=this.REPOSITORY+".BROWSER_NAME",this.BROWSER_VERSION=this.REPOSITORY+".BROWSER_VERSION",this.OS_NAME=this.REPOSITORY+".OS_NAME",this.OS_VERSION=this.REPOSITORY+".OS_VERSION",this.DEVICE_TYPE=this.REPOSITORY+".DEVICE_TYPE",this.SUPPORTED=this.REPOSITORY+".SUPPORTED",this.SERVICE_TIMESTAMP=this.REPOSITORY+".SERVICE_TIMESTAMP",this.LOCATION_TIMESTAMP=this.REPOSITORY+".LOCATION_TIMESTAMP",this.PERMISSION_LOCATION=this.REPOSITORY+".PERMISSION_LOCATION",this.SET_LOG_DEBUG=this.REPOSITORY+".SET_LOG_DEBUG",this.NEW_USER_TIMESTAMP=this.REPOSITORY+".NEW_USER_TIMESTAMP",this.EXTERNAL_ID=this.REPOSITORY+".EXTERNAL_ID",this.REGISTERED_BY_COOKIE=this.REPOSITORY+".REGISTERED_BY_COOKIE",this.LOG_LEVEL=this.REPOSITORY+".LOG_LEVEL",this.LATITUDE=this.REPOSITORY+".LATITUDE",this.LONGITUDE=this.REPOSITORY+".LONGITUDE",this.TOPIC_LIST=this.REPOSITORY+".TOPIC_LIST",this.INAPP_ENABLED=this.REPOSITORY+".INAPP_ENABLED",this.URL_INAPP_API=this.REPOSITORY+".URL_INAPP_API",this.INAPP_TOPICS=this.REPOSITORY+".INAPP_TOPICS",this.AVOID_CYPHER=this.REPOSITORY+".AVOID_CYPHER",this.URL_DEVICE_API=this.REPOSITORY+".URL_DEVICE_API"},e=[{key:"setItemSessionStorage",value:function(t,e){s.default.setItem(t,e)}},{key:"getItemSessionStorage",value:function(t){return s.default.getItem(t)}},{key:"clearSessionStorage",value:function(){s.default.clearMessages()}},{key:"setStorage",value:function(t,e){i.default.setItem(t,e)}},{key:"getStorage",value:function(t){return i.default.getItem(t)}},{key:"clearStorage",value:function(){i.default.clear()}},{key:"setBrowserPublicKey",value:function(t){i.default.setItem(this.BROWSER_PUBLIC_KEY,t)}},{key:"getBrowserPublicKey",value:function(){return i.default.getItem(this.BROWSER_PUBLIC_KEY)}},{key:"setBrowserPrivateKey",value:function(t){i.default.setItem(this.BROWSER_PRIVATE_KEY,t)}},{key:"getBrowserPrivateKey",value:function(){return i.default.getItem(this.BROWSER_PRIVATE_KEY)}},{key:"setAppKey",value:(R=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.default.setItem(this.APP_KEY,e),!o.default||!o.default.IDB){t.next=4;break}return t.next=4,o.default.setItem(this.APP_KEY,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return R.apply(this,arguments)})},{key:"getAppKey",value:function(){return i.default.getItem(this.APP_KEY)}},{key:"getAppKeySync",value:(b=h(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.default||!o.default.IDB){t.next=4;break}return t.next=3,o.default.getItem(this.APP_KEY);case 3:return t.abrupt("return",t.sent);case 4:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"setVAPID",value:function(t){i.default.setItem(this.VAPID_PUBLIC,t)}},{key:"getVAPID",value:function(){return i.default.getItem(this.VAPID_PUBLIC)}},{key:"setEnabled",value:function(t){i.default.setItem(this.ENABLED,t)}},{key:"getEnabled",value:function(){return i.default.getItem(this.ENABLED)}},{key:"setServiceSyncTime",value:function(t){i.default.setItem(this.SERVICE_SYNC_TIME,t*this.BASE_TIME)}},{key:"getServiceSyncTime",value:function(){var t=i.default.getItem(this.SERVICE_SYNC_TIME);return t||1*this.BASE_TIME}},{key:"setLocationEnabled",value:function(t){i.default.setItem(this.LOCATION_ENABLED,t)}},{key:"getLocationEnabled",value:function(){return i.default.getItem(this.LOCATION_ENABLED)}},{key:"setLocationUpdateMinutes",value:function(t){i.default.setItem(this.LOCATION_UPDATE_MINUTES,t)}},{key:"getLocationUpdateMinutes",value:function(){var t=i.default.getItem(this.LOCATION_UPDATE_MINUTES);return t||30}},{key:"setRequestLocation",value:(T=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REQUEST_LOCATION,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return T.apply(this,arguments)})},{key:"getRequestLocation",value:function(){return!!i.default&&i.default.getItem(this.REQUEST_LOCATION)}},{key:"setPlatform",value:(S=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.PLATFORM,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return S.apply(this,arguments)})},{key:"getPlatform",value:function(){return i.default&&i.default.getItem(this.PLATFORM)||n.default.platform}},{key:"getVersion",value:function(){return n.default.version}},{key:"setBrowserName",value:(_=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.BROWSER_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return _.apply(this,arguments)})},{key:"getBrowserName",value:function(){return i.default.getItem(this.BROWSER_NAME)}},{key:"setBrowserVersion",value:function(t){i.default.setItem(this.BROWSER_VERSION,t)}},{key:"getBrowserVersion",value:function(){return i.default.getItem(this.BROWSER_VERSION)}},{key:"setOsName",value:(I=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.OS_NAME,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return I.apply(this,arguments)})},{key:"getOsName",value:function(){return i.default.getItem(this.OS_NAME)}},{key:"setOsVersion",value:function(t){i.default.setItem(this.OS_VERSION,t)}},{key:"getOsVersion",value:function(){return i.default.getItem(this.OS_VERSION)}},{key:"setDeviceType",value:function(t){i.default.setItem(this.DEVICE_TYPE,t)}},{key:"getDeviceType",value:function(){return i.default.getItem(this.DEVICE_TYPE)}},{key:"setSupported",value:function(t){i.default.setItem(this.SUPPORTED,t)}},{key:"getSupported",value:function(){return i.default.getItem(this.SUPPORTED)}},{key:"setServiceTimestamp",value:function(t){i.default.setItem(this.SERVICE_TIMESTAMP,t)}},{key:"getServiceTimestamp",value:function(){return i.default.getItem(this.SERVICE_TIMESTAMP)}},{key:"setLocationTimestamp",value:function(t){i.default.setItem(this.LOCATION_TIMESTAMP,t)}},{key:"getLocationTimestamp",value:function(){return i.default.getItem(this.LOCATION_TIMESTAMP)}},{key:"setPermissionLocation",value:function(t){i.default.setItem(this.PERMISSION_LOCATION,t)}},{key:"getPermissionLocation",value:function(){return i.default.getItem(this.PERMISSION_LOCATION)}},{key:"setDebugLog",value:function(t){i.default.setItem(this.SET_LOG_DEBUG,t)}},{key:"getDebugLog",value:function(){return"false"!==i.default.getItem(this.SET_LOG_DEBUG)}},{key:"setLogLevel",value:function(t){i.default.setItem(this.LOG_LEVEL,t)}},{key:"getLogLevel",value:function(){return i.default.getItem(this.LOG_LEVEL)}},{key:"setNewUserTimestamp",value:function(t){i.default.setItem(this.NEW_USER_TIMESTAMP,t)}},{key:"getNewUserTimestamp",value:function(){return i.default.getItem(this.NEW_USER_TIMESTAMP)}},{key:"setExternalIdRequest",value:(m=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i.default&&i.default.isLocalStorageAvailable()&&i.default.setItem(this.EXTERNAL_ID,e),!o.default||!o.default.IDB){t.next=4;break}return t.next=4,o.default.setItem(this.EXTERNAL_ID,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return m.apply(this,arguments)})},{key:"getExternalIdRequest",value:(g=h(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!i.default||!i.default.isLocalStorageAvailable()){t.next=5;break}e=i.default.getItem(this.EXTERNAL_ID),t.next=9;break;case 5:if(!o.default||!o.default.IDB){t.next=9;break}return t.next=8,o.default.getItem(this.EXTERNAL_ID);case 8:e=t.sent;case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return g.apply(this,arguments)})},{key:"setExternalId",value:function(t){i.default.setItem(this.EXTERNAL_ID,t)}},{key:"getExternalId",value:function(){return i.default.getItem(this.EXTERNAL_ID)}},{key:"getRegisteredByCookie",value:(v=h(u().mark((function t(){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",i.default.getItem(this.REGISTERED_BY_COOKIE));case 1:case"end":return t.stop()}}),t,this)}))),function(){return v.apply(this,arguments)})},{key:"setRegisteredByCookie",value:(y=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i.default.setItem(this.REGISTERED_BY_COOKIE,e);case 1:case"end":return t.stop()}}),t,this)}))),function(t){return y.apply(this,arguments)})},{key:"setLatitude",value:function(t){i.default.setItem(this.LATITUDE,t)}},{key:"getLatitude",value:function(){return i.default.getItem(this.LATITUDE)}},{key:"setLongitude",value:function(t){i.default.setItem(this.LONGITUDE,t)}},{key:"getLongitude",value:function(){return i.default.getItem(this.LONGITUDE)}},{key:"setInAppTopicList",value:(E=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.db||!this.db.IDB){t.next=3;break}return t.next=3,this.db.setItem(this.INAPP_TOPICS,e);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return E.apply(this,arguments)})},{key:"getInAppTopicList",value:(d=h(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.db||!this.db.IDB){t.next=5;break}return t.next=4,this.db.getItem(this.INAPP_TOPICS);case 4:e=t.sent;case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.abrupt("return",e);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return d.apply(this,arguments)})},{key:"setTopicList",value:(p=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.db||!this.db.IDB){t.next=3;break}return t.next=3,this.db.setItem(this.TOPIC_LIST,e);case 3:case"end":return t.stop()}}),t,this)}))),function(t){return p.apply(this,arguments)})},{key:"getTopicList",value:(l=h(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.db||!this.db.IDB){t.next=5;break}return t.next=4,this.db.getItem(this.TOPIC_LIST);case 4:e=t.sent;case 5:t.next=9;break;case 7:t.prev=7,t.t0=t.catch(0);case 9:return t.abrupt("return",e);case 10:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return l.apply(this,arguments)})},{key:"getUrlInappApi",value:function(){return this.getStorage(this.URL_INAPP_API)}},{key:"setUrlInappApi",value:function(t){this.setStorage(this.URL_INAPP_API,t)}},{key:"setInAppEnabled",value:function(t){this.setStorage(this.INAPP_ENABLED,t)}},{key:"isInAppEnabled",value:function(){return this.getStorage(this.INAPP_ENABLED)}},{key:"setAvoidCypher",value:function(t){this.setStorage(this.AVOID_CYPHER,t)}},{key:"isAvoidCypher",value:function(){return this.getStorage(this.AVOID_CYPHER)}},{key:"getUrlDeviceApi",value:(c=h(u().mark((function t(){var e;return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!this.storage||!this.storage.isLocalStorageAvailable()){t.next=5;break}e=this.getStorage(this.URL_DEVICE_API),t.next=9;break;case 5:if(!this.db||!this.db.IDB){t.next=9;break}return t.next=8,this.db.getItem(this.URL_DEVICE_API);case 8:e=t.sent;case 9:t.next=13;break;case 11:t.prev=11,t.t0=t.catch(0);case 13:return t.abrupt("return",e);case 14:case"end":return t.stop()}}),t,this,[[0,11]])}))),function(){return c.apply(this,arguments)})},{key:"setUrlDeviceApi",value:(a=h(u().mark((function t(e){return u().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.storage&&this.storage.isLocalStorageAvailable()&&this.setStorage(this.URL_DEVICE_API,e),!this.db||!this.db.IDB){t.next=4;break}return t.next=4,this.db.setItem(this.URL_DEVICE_API,e);case 4:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})}],e&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,a,c,l,p,d,E,y,v,g,m,I,_,S,T,b,R}();e.default=d},238:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.SESSION="indigitall.session.storage",this.session=this.isSessionStorageAvailable()?window.sessionStorage:null},e=[{key:"isSessionStorageAvailable",value:function(){try{var t=window.sessionStorage,e="__storage_test__";if(t)return t.setItem(e,e),t.removeItem(e),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==o.length}return!1}},{key:"getItem",value:function(t){return null!=this.session?this.session.getItem(t):null}},{key:"setItem",value:function(t,e){return null!=this.session&&(this.session.setItem(t,e),!0)}},{key:"clearMessages",value:function(){this.session&&this.session.removeItem("messages")}}],e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}());e.default=o},622:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(291))&&n.__esModule?n:{default:n};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c=function(){return function(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),null,[{key:"isServiceTimestampExceed",value:function(){return!(new i.default).getServiceTimestamp()||(new i.default).getServiceSyncTime()<=(Date.now()-(new i.default).getServiceTimestamp())/6e4}},{key:"isFunction",value:function(t){return!(!t||"function"!=typeof t)}}])}();e.default=c},429:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(254))&&n.__esModule?n:{default:n};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,s=Object.create(o.prototype),a=new C(n||[]);return i(s,"_invoke",{value:w(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",E="suspendedYield",y="executing",v="completed",g={};function m(){}function I(){}function _(){}var S={};h(S,c,(function(){return this}));var T=Object.getPrototypeOf,b=T&&T(T(D([])));b&&b!==r&&n.call(b,c)&&(S=b);var R=_.prototype=m.prototype=Object.create(S);function P(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(i,s,a,c){var u=p(t[i],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function w(e,r,n){var i=d;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var u=p(e,r,n);if("normal"===u.type){if(i=n.done?v:E,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return I.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:I,configurable:!0}),I.displayName=h(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===I||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,l,"GeneratorFunction")),t.prototype=Object.create(R),t},e.awrap=function(t){return{__await:t}},P(O.prototype),h(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new O(f(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(R),h(R,l,"Generator"),h(R,c,(function(){return this})),h(R,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e,r,n,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function c(t){return function(){var e=this,r=arguments;return new Promise((function(n,i){var o=t.apply(e,r);function s(t){a(o,n,i,s,c,"next",t)}function c(t){a(o,n,i,s,c,"throw",t)}s(void 0)}))}}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,l(n.key),n)}}function l(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var h=function(){return function(t,e,r){return e&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),null,[{key:"getPermissions",value:(n=c(s().mark((function t(){var e,r;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission("geolocation");case 2:return e=t.sent,r={},e&&(r.location=e.state),t.abrupt("return",r);case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"getPermission",value:(r=c(s().mark((function t(e){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(navigator&&navigator.permissions&&navigator.permissions.query&&e)){t.next=5;break}return t.next=4,navigator.permissions.query({name:e,userVisibleOnly:!0});case 4:return t.abrupt("return",t.sent);case 5:t.next=10;break;case 7:return t.prev=7,t.t0=t.catch(0),t.abrupt("return",null);case 10:return t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,null,[[0,7]])}))),function(t){return r.apply(this,arguments)})},{key:"setPermissionsCallback",value:(e=c(s().mark((function t(){return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.setCallback("geolocation",navigator.indigitallRequestLocationPermission);case 2:case"end":return t.stop()}}),t,this)}))),function(){return e.apply(this,arguments)})},{key:"setCallback",value:(t=c(s().mark((function t(e,r){var n,o;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.getPermission(e);case 2:(n=t.sent)&&(o=n.state,"onchange"in n&&(n.onchange=function(){new i.default("[IND]CorePermissions: ").d(e+" permission state has changed from "+o+" to "+n.state).writeLog(),o=n.state,r&&r({name:e,state:n.state})}));case 4:case"end":return t.stop()}}),t,this)}))),function(e,r){return t.apply(this,arguments)})}]);var t,e,r,n}();e.default=h},170:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CryptoUtils=void 0;var n=i(r(291));function i(t){return t&&t.__esModule?t:{default:t}}function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(){s=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},c=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function h(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{h({},"")}catch(t){h=function(t,e,r){return t[e]=r}}function f(t,e,r,n){var o=e&&e.prototype instanceof m?e:m,s=Object.create(o.prototype),a=new C(n||[]);return i(s,"_invoke",{value:w(t,r,a)}),s}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=f;var d="suspendedStart",E="suspendedYield",y="executing",v="completed",g={};function m(){}function I(){}function _(){}var S={};h(S,c,(function(){return this}));var T=Object.getPrototypeOf,b=T&&T(T(D([])));b&&b!==r&&n.call(b,c)&&(S=b);var R=_.prototype=m.prototype=Object.create(S);function P(t){["next","throw","return"].forEach((function(e){h(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(i,s,a,c){var u=p(t[i],t,s);if("throw"!==u.type){var l=u.arg,h=l.value;return h&&"object"==o(h)&&n.call(h,"__await")?e.resolve(h.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(h).then((function(t){l.value=t,a(l)}),(function(t){return r("throw",t,a,c)}))}c(u.arg)}var s;i(this,"_invoke",{value:function(t,n){function i(){return new e((function(e,i){r(t,n,e,i)}))}return s=s?s.then(i,i):i()}})}function w(e,r,n){var i=d;return function(o,s){if(i===y)throw Error("Generator is already running");if(i===v){if("throw"===o)throw s;return{value:t,done:!0}}for(n.method=o,n.arg=s;;){var a=n.delegate;if(a){var c=A(a,n);if(c){if(c===g)continue;return c}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===d)throw i=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=y;var u=p(e,r,n);if("normal"===u.type){if(i=n.done?v:E,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(i=v,n.method="throw",n.arg=u.arg)}}}function A(e,r){var n=r.method,i=e.iterator[n];if(i===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,A(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var o=p(i,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,g;var s=o.arg;return s?s.done?(r[e.resultName]=s.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function L(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function C(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function D(e){if(e||""===e){var r=e[c];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,s=function r(){for(;++i<e.length;)if(n.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return s.next=s}}throw new TypeError(o(e)+" is not iterable")}return I.prototype=_,i(R,"constructor",{value:_,configurable:!0}),i(_,"constructor",{value:I,configurable:!0}),I.displayName=h(_,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===I||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,_):(t.__proto__=_,h(t,l,"GeneratorFunction")),t.prototype=Object.create(R),t},e.awrap=function(t){return{__await:t}},P(O.prototype),h(O.prototype,u,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,i,o){void 0===o&&(o=Promise);var s=new O(f(t,r,n,i),o);return e.isGeneratorFunction(r)?s:s.next().then((function(t){return t.done?t.value:s.next()}))},P(R),h(R,l,"Generator"),h(R,c,(function(){return this})),h(R,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=D,C.prototype={constructor:C,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(L),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function i(n,i){return a.type="throw",a.arg=e,r.next=n,i&&(r.method="next",r.arg=t),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var c=n.call(s,"catchLoc"),u=n.call(s,"finallyLoc");if(c&&u){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(c){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=t,s.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(s)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),L(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var i=n.arg;L(r)}return i}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:D(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function a(t,e,r,n,i,o,s){try{var a=t[o](s),c=a.value}catch(t){return void r(t)}a.done?e(c):Promise.resolve(c).then(n,i)}function c(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,u(n.key),n)}}function u(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var l=new(i(r(254)).default)("[IND]Crypto"),h=new TextEncoder("utf-8"),f="HMAC",p=e.CryptoUtils=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=null,r=[{key:"createHmac",value:(i=s().mark((function t(e,r){var i,o,a,c,u,p;return s().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,i="",!0!==(new n.default).isAvoidCypher()){t.next=6;break}i=r,t.next=18;break;case 6:if(a=null===(o=window)||void 0===o||null===(o=o.crypto)||void 0===o?void 0:o.subtle){t.next=9;break}return t.abrupt("return");case 9:return t.next=11,a.importKey("raw",h.encode(e),{name:f,hash:{name:"SHA-256"}},!1,["sign","verify"]);case 11:return c=t.sent,t.next=14,a.sign(f,c,h.encode(r));case 14:u=t.sent,p=new Uint8Array(u),i=Array.prototype.map.call(p,(function(t){return("00"+t.toString(16)).slice(-2)})).join(""),l.d("hmac: ",i).writeLog();case 18:return t.abrupt("return",i);case 21:return t.prev=21,t.t0=t.catch(0),l.e("error:",t.t0).writeLog(),t.abrupt("return");case 25:case"end":return t.stop()}}),t,null,[[0,21]])})),o=function(){var t=this,e=arguments;return new Promise((function(r,n){var o=i.apply(t,e);function s(t){a(o,r,n,s,c,"next",t)}function c(t){a(o,r,n,s,c,"throw",t)}s(void 0)}))},function(t,e){return o.apply(this,arguments)})}],e&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,i,o}();e.default=p},457:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n,i=(n=r(234))&&n.__esModule?n:{default:n};function o(t){return o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},o(t)}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function a(t){var e=function(t,e){if("object"!=o(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==o(e)?e:e+""}var c=function(){return function(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}((function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}),[{key:"showError",value:function(t,e,r){if(null!=t){var n=Object.values(t.ErrorCode).indexOf(e);return n>=0?new i.default(Object.keys(t.ErrorCode)[n],Object.keys(t.ErrorMessage)[n],r):new i.default(GENERAL_ERROR,"general error",r)}}}])}();e.default=new c},325:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},i=[{key:"compareJSON",value:function(t,e){var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var o=0,s=n;o<s.length;o++){var a=s[o];if(t[a]!==e[a]){if("object"!=r(t[a])||"object"!=r(e[a]))return!1;if(!isEqual(t[a],e[a]))return!1}}return!0}}],(e=null)&&n(t.prototype,e),i&&n(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,i}();e.default=o},254:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=o(r(291)),i=o(r(630));function o(t){return t&&t.__esModule?t:{default:t}}function s(t){return s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},s(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t,e){if("object"!=s(t)||!t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,e||"default");if("object"!=s(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==s(e)?e:e+""}var u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.tag="[IND]",e&&(this.tag=e),this.level=i.default.INFO,this.setLogLevel((new n.default).getLogLevel()),this.log=[]}return e=t,r=[{key:"setLogLevel",value:function(t){t&&t>=i.default.DEBUG&&t<=i.default.ERROR&&(this.level=t)}},{key:"d",value:function(){if(this.level<=i.default.DEBUG)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"i",value:function(){if(this.level<=i.default.INFO)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"w",value:function(){if(this.level<=i.default.WARNING)for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"e",value:function(){if(this.level<=i.default.ERROR)if(1==arguments.length&&arguments.errorCode)this.log+="".concat(error.errorCode,": ").concat(error.errorMessage);else for(var e=0;e<arguments.length;e++)this.log+=t.addedAsString(arguments[e]);return this}},{key:"writeLog",value:function(){this.log.length>0&&this.tag&&this.log&&console.log(this.tag,this.log),this.log=[]}}],o=[{key:"addedAsString",value:function(t){return"string"==typeof t?t:JSON.stringify(t,null,2)}}],r&&a(e.prototype,r),o&&a(e,o),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,r,o}();e.default=u},630:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.LogLevel=void 0;var r=e.LogLevel=Object.freeze({DEBUG:1,INFO:2,WARNING:3,ERROR:4});e.default=r},662:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},r=[{key:"setTopicChannel",value:function(t,e){for(var r=[],n=0;n<t.length;n++){var i=t[n];i.channel=e,r.push(i)}return r}}],(e=null)&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();e.default=o},332:(t,e)=>{"use strict";function r(t){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},r(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,i(n.key),n)}}function i(t){var e=function(t,e){if("object"!=r(t)||!t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=r(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==r(e)?e:e+""}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},r=[{key:"isValidFormat",value:function(t){return null!=t&&""!=t&&"null"!=t&&t.length>8}}],(e=null)&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();e.default=o},628:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"CommonUtils",{enumerable:!0,get:function(){return n.default}}),Object.defineProperty(e,"CorePermissions",{enumerable:!0,get:function(){return i.default}}),Object.defineProperty(e,"CryptoUtils",{enumerable:!0,get:function(){return o.default}}),Object.defineProperty(e,"ErrorUtils",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(e,"JsonUtils",{enumerable:!0,get:function(){return a.default}}),Object.defineProperty(e,"Log",{enumerable:!0,get:function(){return c.default}}),Object.defineProperty(e,"LogLevel",{enumerable:!0,get:function(){return u.LogLevel}}),Object.defineProperty(e,"TopicUtils",{enumerable:!0,get:function(){return h.default}}),Object.defineProperty(e,"Validations",{enumerable:!0,get:function(){return l.default}});var n=f(r(622)),i=f(r(429)),o=f(r(170)),s=f(r(457)),a=f(r(325)),c=f(r(254)),u=r(630),l=f(r(332)),h=f(r(662));function f(t){return t&&t.__esModule?t:{default:t}}},904:t=>{"use strict";t.exports=JSON.parse('{"_from":"indigitall-web-core@4.7.0","_id":"indigitall-web-core@4.7.0","_inBundle":false,"_integrity":"sha512-PtIjUUDzwpRhkA8R2cYt9MnL21hUO48lUk2KYCBNu5yrutMtYnyqe8g7u/C1lye3hNTkv6uLoJxVMIvSWi1n+w==","_location":"/indigitall-web-core","_phantomChildren":{},"_requested":{"type":"version","registry":true,"raw":"indigitall-web-core@4.7.0","name":"indigitall-web-core","escapedName":"indigitall-web-core","rawSpec":"4.7.0","saveSpec":null,"fetchSpec":"4.7.0"},"_requiredBy":["#USER","/","/indigitall-web-inbox"],"_resolved":"https://registry.npmjs.org/indigitall-web-core/-/indigitall-web-core-4.7.0.tgz","_shasum":"13f8e7cba08b2c61633672f091844a0698207683","_spec":"indigitall-web-core@4.7.0","_where":"/home/circleci/webpush/push","author":{"name":"Smart2me S.L."},"bundleDependencies":false,"deprecated":false,"description":"indigitall web core","devDependencies":{"@babel/preset-env":"^7.18.10","babel-loader":"^8.2.5","filemanager-webpack-plugin":"^7.0.0","idempotent-babel-polyfill":"^7.4.4","script-loader":"^0.7.2","webpack":"^5.74.0","webpack-bundle-analyzer":"^4.6.1","webpack-cli":"^4.10.0"},"homepage":"https://indigitall.com","main":"index.js","name":"indigitall-web-core","scripts":{"build":"webpack --config webpack.config.js --mode=production","build-dev":"webpack --config webpack.config.js --watch --mode=development","delete-node-modules":"rm -rf node_modules/ && rm -f package-lock.json","install-core":"npm install && npm run build","public":"ws --directory ./public --port 80 --log.format dev","test":"echo \'There are not tests\'"},"version":"4.7.0"}')}},e={};function r(n){var i=e[n];if(void 0!==i)return i.exports;var o=e[n]={exports:{}};return t[n].call(o.exports,o,o.exports,r),o.exports}return(()=>{"use strict";const t=new class{constructor(){this.TOPIC_SYNC_TIMESTAMP=3e4,this.TOPIC_SYNC_TAG="syncTopics",this.TOPIC_SYNC_SUBSCRIBE_CALLBACK="indigitallSyncTopicSubscribeOnSuccess",this.TOPIC_SYNC_SUBSCRIBE_ERROR_CALLBACK="indigitallSyncTopicSubscribeOnError",this.TOPIC_SYNC_UNSUBSCRIBE_CALLBACK="indigitallSyncTopicUnsubscribeOnSuccess",this.TOPIC_SYNC_UNSUBSCRIBE_ERROR_CALLBACK="indigitallSyncTopicUnsubscribeOnError"}},{Repository:e}=r(315).Core;const n=new class extends e{constructor(){super(),this.SAFARI_WEBSITE_PUSH_ID=this.REPOSITORY+".SAFARI_WEBSITE_PUSH_ID",this.PUSH_TOKEN=this.REPOSITORY+".PUSH_TOKEN",this.PERMISSION_PUSH=this.REPOSITORY+".PERMISSION_PUSH",this.DEVICE_JSON=this.REPOSITORY+".DEVICE_JSON",this.PUT_REQUEST_TIMESTAMP=this.REPOSITORY+".PUT_REQUEST_TIMESTAMP",this.WORKER_PATH=this.REPOSITORY+".WORKER_PATH",this.TEST=this.REPOSITORY+".TEST",this.SAFARI_GESTURE_REQUEST_PERMISSION=this.REPOSITORY+".SAFARI_GESTURE_REQUEST_PERMISSION",this.UPDATE_TOPIC_SUBSCRIBE=this.REPOSITORY+".UPDATE_TOPIC_SUBSCRIBE",this.TOPIC_SYNC_TIMESTAMP=this.REPOSITORY+".TOPIC_SYNC_TIMESTAMP",this.TOPIC_SEMAPHORE=this.REPOSITORY+".TOPIC_SEMAPHORE",this.TOPIC_SYNC_IS_PROCESSING=this.REPOSITORY+".TOPIC_SYNC_IS_PROCESSING"}async setDeviceId(t){this.storage&&this.storage.isLocalStorageAvailable()&&this.setStorage(this.DEVICE_ID,t),this.db&&this.db.IDB&&await this.db.setItem(this.DEVICE_ID,t)}getDeviceId(){return this.getStorage(this.DEVICE_ID)}async getDeviceIdSync(){if(this.db&&this.db.IDB)return await this.db.getItem(this.DEVICE_ID)}setPushToken(t){this.setStorage(this.PUSH_TOKEN,t)}getPushToken(){return this.getStorage(this.PUSH_TOKEN)}setSafariWebsitePushId(t){this.setStorage(this.SAFARI_WEBSITE_PUSH_ID,t)}getSafariWebsitePushId(){return this.getStorage(this.SAFARI_WEBSITE_PUSH_ID)}setPermissionPush(t){this.setStorage(this.PERMISSION_PUSH,t)}getPermissionPush(){return this.getStorage(this.PERMISSION_PUSH)}async getDeviceJson(){return this.getStorage(this.DEVICE_JSON)}async setDeviceJson(t){this.setStorage(this.DEVICE_JSON,t)}async getPutRequestTimestamp(){return this.getStorage(this.PUT_REQUEST_TIMESTAMP)}async setPutRequestTimestamp(t){this.setStorage(this.PUT_REQUEST_TIMESTAMP,t)}setWorkerPath(t){this.setStorage(this.WORKER_PATH,t)}getWorkerPath(){return this.getStorage(this.WORKER_PATH)}setTestValue(t){this.setStorage(this.TEST,t)}getTestValue(){return this.getStorage(this.TEST)}setSafariGestureRequestPermission(t){this.setStorage(this.SAFARI_GESTURE_REQUEST_PERMISSION,t)}getSafariGestureRequestPermission(){return this.getStorage(this.SAFARI_GESTURE_REQUEST_PERMISSION)}async setUpdateTopicSubscribe(t){this.db&&this.db.IDB&&await this.db.setItem(this.UPDATE_TOPIC_SUBSCRIBE,t)}async getUpdateTopicSubscribe(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.UPDATE_TOPIC_SUBSCRIBE))}catch(t){}return t}async setTopicSyncTimestamp(t){this.db&&this.db.IDB&&await this.db.setItem(this.TOPIC_SYNC_TIMESTAMP,t)}async getTopicSyncTimestamp(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.TOPIC_SYNC_TIMESTAMP))}catch(t){}return t}async setTopicSemaphore(t){this.db&&this.db.IDB&&await this.db.setItem(this.TOPIC_SEMAPHORE,t)}async getTopicSemaphore(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.TOPIC_SEMAPHORE))}catch(t){}return t}async setTopicSyncIsProcessing(t){this.db&&this.db.IDB&&await this.db.setItem(this.TOPIC_SYNC_IS_PROCESSING,t)}async getTopicSyncIsProcessing(){let t;try{this.db&&this.db.IDB&&(t=await this.db.getItem(this.TOPIC_SYNC_IS_PROCESSING))}catch(t){}return t}},{ErrorDictionary:i}=r(315).Core.Models,o=i.ErrorCode;Object.assign(o,{GENERAL_ERROR_BAD_REQUEST:601,GENERAL_ERROR_APPKEY_BAD_REQUEST:602,PUSH_INITIALIZATION_ERROR:1e3,PUSH_RECEPTION_ERROR:1200,PUSH_TOPICS_ERROR:1400,PUSH_DEVICE_ERROR:1500,PUSH_EVENT_ERROR:1600,API_APPKEY_NOT_VALID:1601});const s=i.ErrorMessage;Object.assign(s,{GENERAL_ERROR_BAD_REQUEST:"AppKey or DeviceId are null or empty",GENERAL_ERROR_APPKEY_BAD_REQUEST:"AppKey is null or empty",PUSH_INITIALIZATION_ERROR:"initialization error",PUSH_RECEPTION_ERROR:"push reception error",PUSH_TOPICS_ERROR:"push topics error",PUSH_DEVICE_ERROR:"device error",PUSH_EVENT_ERROR:"event error",API_APPKEY_NOT_VALID:"appKey is missing'"});const a={ErrorCode:o,ErrorMessage:s},{BaseRequest:c}=r(315).Core.Api,{EventType:u}=r(315).Core.Models;const l=class extends c{constructor(){super()}setEventType(t){this.eventType=t}setPushId(t){this.pushId=t}setClickedButton(t){this.clickedButton=t}setSendingId(t){this.sendingId=t}setPermissionType(t){this.permissionType=t}setLocation(t,e){this.latitude=t,this.longitude=e}setDeviceId(t){this.deviceId=t}setPlatform(t){this.platform=t}setAppKey(t){this.appKey=t}setCustomData(t){this.customData=t}async setExternalCodeRequest(){this.externalCode=await n.getExternalIdRequest()}setExternalCode(t){this.externalCode=t}setCampaingId(t){this.campaignId=t}setJourneyStateId(t){this.journeyStateId=t}setJourneyExecution(t){this.journeyExecution=t}setCjCurrentStateId(t){this.cjCurrentStateId=t}postEventPushRequest(){const t={};return t.deviceId=this.deviceId,t.platform=this.platform,this.eventType&&(t.eventType=this.eventType),this.pushId&&(t.pushId=this.pushId),t.clickedButton=this.clickedButton,null!=this.externalCode&&(t.externalCode=this.externalCode),this.sendingId&&"undefined"!=this.sendingId&&(t.sendingId=this.sendingId),this.journeyStateId&&(t.journeyStateId=this.journeyStateId),this.journeyExecution&&(t.journeyExecution=this.journeyExecution),this.cjCurrentStateId&&(t.cjCurrentStateId=this.cjCurrentStateId),this.campaignId&&(t.campaignId=this.campaignId),this.body=t,this}postEventVisitRequest(){const t={};return t.deviceId=n.getDeviceId(),t.eventType=u.EVENT_TYPE_UPDATE,this.body=t,this}postEventPermissionRequest(){const t={};return t.deviceId=n.getDeviceId(),this.eventType&&(t.eventType=this.eventType),this.permissionType&&(t.permissionType=this.permissionType),this.body=t,this}postEventLocationRequest(){const t={};return t.deviceId=n.getDeviceId(),t.eventType=u.EVENT_TYPE_UPDATE,this.latitude&&(t.latitude=this.latitude),this.longitude&&(t.longitude=this.longitude),this.body=t,this}postEventCustomRequest(){const t={};return this.deviceId&&(t.deviceId=this.deviceId),this.eventType&&(t.eventType=this.eventType),this.customData&&(t.customData=this.customData),this.externalCode&&(t.externalCode=this.externalCode),this.body=t,this}};const h=class{static urlBase64ToUint8Array(t){const e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length);for(let t=0;t<r.length;++t)n[t]=r.charCodeAt(t);return n}static callEventPermission(t,e){const r=new l;r.setAppKey(n.getAppKey()),r.setDeviceId(n.getDeviceId()),r.setPermissionType(t),r.setEventType(e),R.postEventPermission(r)}static async getPutRequestTimestamp(){return await n.getPutRequestTimestamp()?n.getPutRequestTimestamp():Date.now()+6048e5}},{Validations:f,Log:p}=r(315).Core.Utils;const d=class extends f{static isAppKeyFormat(){const t=n.getAppKey();return null!=t&&""!=t&&"null"!=t&&t.length>3}static isValidFormatRequest(){const t=new p("[IND]PushValidations: "),e=n.getDeviceId();let r=!0;return this.isAppKeyFormat()||(r=!1,t.w("appKey is null or empty").writeLog()),this.isValidFormat(e)||(r=!1,t.w("deviceId is null or empty").writeLog()),r}static async isPutRequestExceed(){return await h.getPutRequestTimestamp()<=Date.now()}static isSafariBrowserDevice(){const t=window.navigator.userAgent,e=!!t.match(/iPad/i)||!!t.match(/iPhone/i),r=!!t.match(/WebKit/i);return e&&r&&!t.match(/CriOS/i)&&!t.match(/OPiOS/i)}},{Device:E}=r(315).Core.Models;const y=class extends E{constructor(t=null,e){super(t,e),null==t?(null!=n.getDeviceId()&&(this.deviceId=n.getDeviceId()),null!=n.getPushToken()&&(this.pushToken=n.getPushToken())):e?t.deviceId&&(this.deviceId=t.deviceId,n.setDeviceId(this.deviceId)):(t.deviceId&&(this.deviceId=t.deviceId),t.pushToken&&(this.pushToken=t.pushToken))}static setDeviceJson(t){n.setDeviceJson(JSON.stringify(t.toJSON()))}getDeviceId(){return this.deviceId}getPushToken(){return this.pushToken}toJSON(){const t=super.toJSON();return this.deviceId&&(t.deviceId=this.deviceId),this.pushToken&&(t.pushToken=this.pushToken),t}},{Config:v}=r(315).Core,{BaseClient:g}=r(315).Core.Api,{ErrorModel:m,Channel:I}=r(315).Core.Models,{TopicUtils:_,Log:S,CommonUtils:T,ErrorUtils:b}=r(315).Core.Utils;const R=new class extends g{constructor(){super(),this.URL_BASE=v.client.URL_BASE,this.ENDPOINT_APPLICATION="/application",this.ENDPOINT_APPLICATION_ALL=this.ENDPOINT_APPLICATION+"/all",this.ENDPOINT_DEVICE="/device",this.ENDPOINT_DEVICE_TOPICS=this.ENDPOINT_DEVICE+"/topics",this.ENDPOINT_PUSH="/push",this.ENDPOINT_EVENT="/event",this.ENDPOINT_EVENT_PUSH=this.ENDPOINT_EVENT+"/push",this.ENDPOINT_EVENT_VISIT=this.ENDPOINT_EVENT+"/visit",this.ENDPOINT_EVENT_PERMISSION=this.ENDPOINT_EVENT+"/permission",this.ENDPOINT_EVENT_LOCATION=this.ENDPOINT_EVENT+"/location",this.ENDPOINT_EVENT_CUSTOM=this.ENDPOINT_EVENT+"/custom",this.ENDPOINT_EVENT_CUSTOM_BEACON=this.ENDPOINT_EVENT_CUSTOM+"/beacon",this.ENDPOINT_BROWSER="/browser",this.log=new S("[IND]Client: ")}async getURL(){const t=await n.getUrlDeviceApi();return t||this.URL_BASE}async getApplicationAll(t,e,r){if(d.isAppKeyFormat()){const n=await this.get(this.ENDPOINT_APPLICATION_ALL,t.getApplicationRequest());!n||n instanceof m?n?T.isFunction(r)&&r(n):T.isFunction(r)&&r():T.isFunction(e)&&e(n)}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.BAD_REQUEST_SERVER_ERROR));return!0}async postDevice(t,e,r){if(d.isAppKeyFormat()){const i=await this.post(this.ENDPOINT_DEVICE,t.postDeviceRequest(),"include");if(!i||i instanceof m)i?T.isFunction(r)&&r(i):T.isFunction(r)&&r();else{const t={enabled:i.data.enabled,deviceId:i.data.deviceId,registeredByCookie:i.data.registeredByCookie};await n.setDeviceId(t.deviceId),T.isFunction(e)&&e(new y(t,!0))}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_APPKEY_BAD_REQUEST));return!0}async putDevice(t,e,r){const i=new y,o=await d.isPutRequestExceed();if(t.deviceUpdate||null==await n.getPutRequestTimestamp()||o)if(d.isValidFormatRequest()){n.setPutRequestTimestamp(await h.getPutRequestTimestamp());const o=await this.put(this.ENDPOINT_DEVICE,t.putDeviceRequest(i),"include");if(!o||o instanceof m)o?T.isFunction(r)&&r(o):T.isFunction(r)&&r();else{const t={enabled:o.data.enabled,deviceId:o.data.deviceId,registeredByCookie:o.data.registeredByCookie};T.isFunction(e)&&e(new y(t,!0))}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));else T.isFunction(e)&&e(i)}async getDevice(t,e,r){if(d.isValidFormatRequest()){const n=await this.get(this.ENDPOINT_DEVICE,t.getDeviceRequest());if(!n||n instanceof m)n?T.isFunction(r)&&r(n):T.isFunction(r)&&r();else{const t={enabled:n.data.enabled,deviceId:n.data.deviceId};T.isFunction(e)&&e(new y(t,!0))}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async getDeviceTopics(t,e,r){if(d.isValidFormatRequest()){const n=await this.get(this.ENDPOINT_DEVICE_TOPICS,t.getDeviceTopicsRequest());!n||n instanceof m?n?T.isFunction(r)&&r(n):T.isFunction(r)&&r():T.isFunction(e)&&e(_.setTopicChannel(n.data.topics,I.PUSH))}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postDeviceTopics(t,e,r){return d.isValidFormatRequest()?await this.postDeviceTopicsRequest(t,e,r):T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST)),!0}async postDeviceTopicsRequest(t,e,r){const n=await this.post(this.ENDPOINT_DEVICE_TOPICS,t.postDeviceTopicsRequest());if(!n||n instanceof m)n?T.isFunction(r)&&r(n):T.isFunction(r)&&r();else{const t=n.data.topics;T.isFunction(e)&&e(t)}}async deleteDeviceTopics(t,e,r){return d.isValidFormatRequest()?this.deleteDeviceTopicsRequest(t,e,r):T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST)),!0}async deleteDeviceTopicsRequest(t,e,r){const n=await this.delete(this.ENDPOINT_DEVICE_TOPICS,t.deleteDeviceTopicsRequest());if(!n||n instanceof m)n?T.isFunction(r)&&r(n):T.isFunction(r)&&r();else{const t=n.data.topics;T.isFunction(e)&&e(t)}}async postEventPush(t){d.isValidFormatRequest()&&await this.post(this.ENDPOINT_EVENT_PUSH,t.postEventPushRequest())}postEventVisit(t){d.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_VISIT,t.postEventVisitRequest())}postEventPermission(t){d.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_PERMISSION,t.postEventPermissionRequest())}postEventLocation(t){d.isValidFormatRequest()&&this.post(this.ENDPOINT_EVENT_LOCATION,t.postEventLocationRequest())}async getBrowser(t,e,r){if(d.isAppKeyFormat()){const i=await this.get(this.ENDPOINT_BROWSER,t);if(!i||i instanceof m)i?T.isFunction(r)&&r(i):T.isFunction(r)&&r();else{const t={browserName:i.data.browserName,browserVersion:i.data.browserVersion,deviceType:i.data.deviceType,osName:i.data.osName,osVersion:i.data.osVersion,supported:i.data.supported,platform:i.data.platform};await n.setBrowserName(t.browserName),n.setBrowserVersion(t.browserVersion),await n.setOsName(t.osName),n.setOsVersion(t.osVersion),n.setDeviceType(t.deviceType),n.setSupported(t.supported),await n.setPlatform("webpush"),T.isFunction(e)&&e(t)}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventCustom(t,e,r){if(d.isValidFormatRequest()){const n=await this.post(this.ENDPOINT_EVENT_CUSTOM,t.postEventCustomRequest());!n||n instanceof m?n?T.isFunction(r)&&r(n):T.isFunction(r)&&r():T.isFunction(e)&&e(n)}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventCustomSync(t,e,r){if(d.isValidFormatRequest()){t=t.postEventCustomRequest();try{if(navigator&&"sendBeacon"in navigator){const r=await this.getURL()+this.ENDPOINT_EVENT_CUSTOM_BEACON+t.getParams();navigator.sendBeacon(r,JSON.stringify(t.getBody())),T.isFunction(e)&&e()}else{const n=await this.getURL()+this.ENDPOINT_EVENT_CUSTOM+t.getParams(),i=new XMLHttpRequest;i.open("POST",n,!1),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&(i.status>=200||i.status<300)?T.isFunction(e)&&e():T.isFunction(r)&&r()},i.send(JSON.stringify(t.getBody()))}}catch(t){T.isFunction(r)&&r(b.showError(a,a.ErrorCode.PUSH_EVENT_ERROR,t))}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventJourney(t,e,r){if(d.isValidFormatRequest()){const n=await this.post(this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM,t.postEventCustomRequest());!n||n instanceof m?n?T.isFunction(r)&&r(n):T.isFunction(r)&&r():T.isFunction(e)&&e(n)}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventJourneySync(t,e,r){if(d.isValidFormatRequest()){t=t.postEventCustomRequest();try{let n=await this.getURL();if(n=n.replace("v1","v2"),navigator&&"sendBeacon"in navigator){const r=n+this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM+t.getParams();navigator.sendBeacon(r,JSON.stringify(t.getBody())),T.isFunction(e)&&e()}else{const n=await this.getURL().replace("v1","v2")+this.ENDPOINT_PUSH+this.ENDPOINT_EVENT_CUSTOM+t.getParams(),i=new XMLHttpRequest;i.open("POST",n,!1),i.setRequestHeader("Content-Type","application/json"),i.onreadystatechange=()=>{i.readyState===XMLHttpRequest.DONE&&(i.status>=200||i.status<300)?T.isFunction(e)&&e():T.isFunction(r)&&r()},i.send(JSON.stringify(t.getBody()))}}catch(t){T.isFunction(r)&&r(b.showError(a,a.ErrorCode.PUSH_EVENT_ERROR,t))}}else T.isFunction(r)&&r(b.showError(a,a.ErrorCode.GENERAL_ERROR_BAD_REQUEST));return!0}async postEventPushClick(t){let e="/event/push";t.journeyStateId&&(t.setJourneyRequest(!0),e="/push/event/click"),t.setServiceWorkerRequest(!0),await this.post(e,t.postEventPushRequest())}async postTopicsSubscribeFromServiceWorker(t){t.setServiceWorkerRequest(!0),await this.post("/device/topics",t.postDeviceTopicsRequest())}},{DeviceStatus:P}=r(315).Core.Models,{BaseRequest:O}=r(315).Core.Api;const w=class extends O{constructor(t=P.DEFAULT){super(),this.device=new y,this.status=t,this.notToUpdate=!1,this.deviceUpdate=!1}isDeviceUpdated(t){this.deviceUpdate=t}setDeviceId(t){this.device&&(this.device.deviceId=t)}setAppKey(t){this.appKey=t}getDeviceRequest(){return this.params=this.createQueryString(),this}postDeviceRequest(){return this.body=this.createDeviceJson(),this.status!==P.DEFAULT&&(this.body.enabled=1===this.status),this}putDeviceRequest(t){return this.params=this.createQueryString(),this.body=this.createPUTDeviceJson(t),this.status!==P.DEFAULT&&(this.body.enabled=1===this.status),this}getDeviceTopicsRequest(){return this.params=this.createQueryString(),this}postDeviceTopicsRequest(){return this.params=this.createQueryString(),this.body=this.createTopicsJson(),this}deleteDeviceTopicsRequest(){return this.params=this.createQueryString(),this.body=this.createTopicsJson(),this}createQueryString(){return this.PARAM_DEVICE_ID+"="+this.device.deviceId}createDeviceJson(){let t={};try{t=this.device.toJSON()}catch(t){}return t}createPUTDeviceJson(t){let e={};try{y.setDeviceJson(t),e=t.toJSON()}catch(t){}return e}createTopicsJson(){const t={};return this.topics&&(t.topics=this.topics),t}getDeviceId(){return this.device.getDeviceId()}setTopics(t){this.topics=t}setExternalCode(t){this.device.setExternalCode(t)}},{EventType:A}=r(315).Core.Models,{Config:N}=r(315).Core;const L=class{static async requestBackgroundSync(){const t=await navigator.serviceWorker.getRegistration(n.getWorkerPath());return null!=t?t:null}static findIndigitallSW(t){for(let e=0;e<t.length;e++)if(void 0!==t[e]&&t[e].active&&t[e].active.scriptURL&&t[e].active.scriptURL.includes("worker.min.js"))return t[e];return null}static async sendEventRequest(t,e){const r=new l;r.setAppKey(t.appKey),r.setDeviceId(t.deviceId),r.setPlatform(N.platform),r.setPushId(""+t.id),r.setSendingId(""+t.sendingId),t.campaignId&&r.setCampaingId(""+t.campaignId),t.journeyStateId&&r.setJourneyStateId(t.journeyStateId),t.journeyExecution&&r.setJourneyExecution(t.journeyExecution),t.cjCurrentStateId&&r.setCjCurrentStateId(t.cjCurrentStateId),r.setEventType(A.EVENT_TYPE_CLICK),await r.setExternalCodeRequest(),"action-1"==e.action?r.setClickedButton(1):"action-2"==e.action?r.setClickedButton(2):r.setClickedButton(0),r.setServiceWorkerRequest(!0),await R.postEventPushClick(r)}static async topicsSubscribeFromServiceWorker(t,e){const r=new w;r.setTopics(e),r.setAppKey(t.appKey),r.setDeviceId(t.deviceId),await R.postTopicsSubscribeFromServiceWorker(r)}};const C=class{constructor(t,e){this.code=t,this.type=e}static getAllCodes(t){const e=[];for(let r=0;r<t.length;r++)e.push(t[r].code);return e}toJSON(){const t={};return this.code&&(t.code=this.code),this.type&&(t.type=this.type),t}},D=Object.freeze({GREEN:"green",RED:"red"}),{TopicSubscribeType:B}=r(315).Core.Models,{CommonUtils:U}=r(315).Core.Utils;class k{static async updateTopic(e,r,i,o){k.checkTopicSemaphore().then((async()=>{await n.setTopicSemaphore(D.RED),await j.getTopicsList((async n=>{await this.setTopicCallbacks(e,i,o),await this.requestTopicBackground(t.TOPIC_SYNC_TAG),await q.updateTopicAction(r,e)}),o)}))}static async checkTopicSemaphore(){if(await n.getTopicSemaphore()!=D.RED)return!0;this.topicSemaphoreWaitTime((()=>!0))}static async topicSemaphoreWaitTime(t){const e=setInterval((async function(){await n.getTopicSemaphore()==D.GREEN&&(clearInterval(e),t())}),1e3)}static async setTopicCallbacks(e,r,n){let i=t.TOPIC_SYNC_SUBSCRIBE_CALLBACK,o=t.TOPIC_SYNC_SUBSCRIBE_ERROR_CALLBACK;e===B.UNSUBSCRIBE&&(i=t.TOPIC_SYNC_UNSUBSCRIBE_CALLBACK,o=t.TOPIC_SYNC_UNSUBSCRIBE_ERROR_CALLBACK);const s=new BroadcastChannel(i);s.onmessage=t=>{U.isFunction(r)&&r(t.data),s.close()};const a=new BroadcastChannel(o);a.onmessage=t=>{U.isFunction(n)&&n(t.data),a.close()}}static async requestTopicBackground(t){const e=await L.requestBackgroundSync();null!=e&&await e.sync.register(t)}static async isTopicTimestampExceed(){const t=await n.getTopicSyncTimestamp();return!(t&&t>Date.now())&&void 0!==t}static async setTopicTimestamp(){const e=Date.now()+t.TOPIC_SYNC_TIMESTAMP;await n.setTopicSyncTimestamp(e)}static indigitallSyncTopicEvent(t,e){new BroadcastChannel(t).postMessage(e)}static topicFilter(t,e){const r=[];if(t)for(let n=0;n<t.length;n++)t[n].type===e&&r.push(t[n].code);return r}static async filterTopicExistingOnIDB(){const t=await n.getUpdateTopicSubscribe(),e=await n.getTopicList(),r=[];for(let n=0;n<t.length;n++)for(let i=0;i<e.length;i++)t[n]&&e[i]&&t[n].code==e[i].code&&(!0===e[i].subscribed&&t[n].type==B.UNSUBSCRIBE||!1===e[i].subscribed&&t[n].type==B.SUBSCRIBE)&&r.push(t[n]);return r}}const M=k,{CommonUtils:x}=r(315).Core.Utils;const j=class{static async setTopicRequest(t){const e=new w;return e.setAppKey(await n.getAppKeySync()),e.setDeviceId(await n.getDeviceIdSync()),e.setServiceWorkerRequest(!0),e.setTopics(t),e}static async getTopicsList(t,e){try{const r=await n.getTopicList();r&&r.length>0?await M.isTopicTimestampExceed()?this.getDeviceTopicClient(t,e):(await n.setTopicSemaphore(D.GREEN),x.isFunction(t)&&t(r)):this.getDeviceTopicClient(t,e)}catch(t){await n.setTopicSemaphore(D.GREEN)}}static async getDeviceTopicClient(t,e){try{R.getDeviceTopics(new w,(async e=>{await M.setTopicTimestamp(),await n.setTopicList(e),await n.setTopicSemaphore(D.GREEN),x.isFunction(t)&&t(e)}),(async t=>{await M.setTopicTimestamp(),await n.setTopicSemaphore(D.GREEN),x.isFunction(e)&&e(t)}))}catch(t){await n.setTopicSemaphore(D.GREEN),x.isFunction(e)&&e(t)}}},{Channel:V,TopicSubscribeType:Y}=r(315).Core.Models,{ErrorUtils:K,Log:F}=r(315).Core.Utils;class G{static async syncTopics(){if(!await n.getTopicSyncIsProcessing()){await n.setTopicSyncIsProcessing(!0);const e=setTimeout((async function(){try{await G.sendTopicSync()}catch(t){}await n.setTopicSyncIsProcessing(!1),clearTimeout(e)}),t.TOPIC_SYNC_TIMESTAMP)}}static async sendTopicSync(){const e=await M.filterTopicExistingOnIDB(),r=M.topicFilter(e,Y.SUBSCRIBE),i=M.topicFilter(e,Y.UNSUBSCRIBE);if(r&&r.length>0)R.postDeviceTopicsRequest(await j.setTopicRequest(r),(async e=>{await M.setTopicTimestamp(),e.channel=V.PUSH,await n.setTopicList(e),M.indigitallSyncTopicEvent(t.TOPIC_SYNC_SUBSCRIBE_CALLBACK,e)}),(async e=>{M.indigitallSyncTopicEvent(t.TOPIC_SYNC_SUBSCRIBE_ERROR_CALLBACK,e)}));else if(i&&i.length>0)R.deleteDeviceTopicsRequest(await j.setTopicRequest(i),(async e=>{await M.setTopicTimestamp(),await n.setTopicList(e),M.indigitallSyncTopicEvent(t.TOPIC_SYNC_UNSUBSCRIBE_CALLBACK,e)}),(async e=>{M.indigitallSyncTopicEvent(t.TOPIC_SYNC_UNSUBSCRIBE_ERROR_CALLBACK,e)}));else{const e=K.showError(a,a.ErrorCode.PUSH_TOPICS_ERROR,"there is no topic with one of the codes in the push topic list");M.indigitallSyncTopicEvent(t.TOPIC_SYNC_SUBSCRIBE_ERROR_CALLBACK,e),M.indigitallSyncTopicEvent(t.TOPIC_SYNC_UNSUBSCRIBE_ERROR_CALLBACK,e)}await n.setUpdateTopicSubscribe([])}static async updateTopicAction(t,e){const r=await n.getUpdateTopicSubscribe();if(r&&r.length>0){const i=new F("[IND]TopicSyncUtils: ");try{const i=[],o=r.filter((e=>t.includes(e.code))),s=t.filter((t=>!C.getAllCodes(r).includes(t)));if(s&&s.length>0)for(let t=0;t<s.length;t++)null!==s[t]&&i.push(new C(s[t],e).toJSON());if(o&&o.length>0)for(let t=0;t<o.length;t++){const n=r.findIndex((e=>e.code===o[t].code)),i=new C(o[t].code,e);r[n]=i.toJSON()}i.length>0&&await n.setUpdateTopicSubscribe(i.concat(r))}catch(t){i.e("updateTopicAction: "+t).writeLog()}}else{const r=[];for(let n=0;n<t.length;n++){const i=t[n];r.push({code:i,type:e})}await n.setUpdateTopicSubscribe(r)}}}const q=G,{Log:W,LogLevel:H}=r(315).Core.Utils,J="[IND]service-worker";async function Q(t,e){await L.topicsSubscribeFromServiceWorker(t,e)}self.addEventListener("push",(async function(t){const e=new W(J);e.setLogLevel(H.DEBUG),e.d("Received a push message ",t.data.json()).writeLog();const r=t.data.json(),n=r.title,i={};r.body&&(i.body=r.body);r.icon&&(i.icon=r.icon);r.image&&("image"in Notification.prototype?i.image=r.image:r.imageSquare?i.icon=r.imageSquare:i.icon=r.image);r.monochrome&&(i.badge=r.monochrome);const o={};o.appKey=r.appKey||"",o.deviceId=r.deviceId||"",o.id=r.id||0,o.sendingId=r.sendingId,o.campaignId=r.campaignId,r.journeyStateId&&(o.journeyStateId=r.journeyStateId);r.journeyExecution&&(o.journeyExecution=r.journeyExecution);r.cjCurrentStateId&&(o.cjCurrentStateId=r.cjCurrentStateId);if(r.action){const t=r.action;e.d("action: ",t).writeLog(),t.url&&(o.url=t.url),t.topics&&(o.topics=t.topics)}if(Array.isArray(r.buttons)){if(!navigator.userAgent.match(/opr\//i)){const t=[],n=[],s=[];e.d("buttons: ",r.buttons).writeLog();for(let e=0;e<r.buttons.length;e++){const i=r.buttons[e];t.push({action:"action-"+(e+1),title:i.label}),i.action&&i.action.url&&n.push(i.action.url),i.action&&i.action.topics&&s.push(i.action.topics)}t.length>0&&(i.actions=t),n.length>0&&(o.actions=n),s.length>0&&(o.buttonTopics=s)}}i.data=o,r.requireInteraction&&(i.requireInteraction=r.requireInteraction);if(r.extraFields&&"object"==typeof r.extraFields){const t={};Object.keys(r.extraFields).forEach((e=>{const n=r.extraFields[e];t[n]=r[e]})),Object.assign(i,t)}t.waitUntil(self.registration.showNotification(n,i))})),self.addEventListener("notificationclick",(async function(t){t.notification.close(),console.log(`${J} On notification click: `,t.notification);const e=t.notification.data;t.waitUntil(clients.matchAll({type:"window"}).then((function(r){for(let t=0;t<r.length;t++){const e=r[t];if("/"===e.url&&"focus"in e)return e.focus()}if(clients.openWindow)return"action-1"==t.action?(e.buttonTopics&&e.buttonTopics.length>0&&void 0!==e.buttonTopics[0]&&Q(e,e.buttonTopics[0]),clients.openWindow(e.actions[0])):"action-2"==t.action?(e.buttonTopics&&e.buttonTopics.length>0&&void 0!==e.buttonTopics[1]&&Q(e,e.buttonTopics[1]),clients.openWindow(e.actions[1])):(e.topics&&e.topics.length>0&&Q(e,e.topics),clients.openWindow(e.url))}))),t.preventDefault(),await L.sendEventRequest(e,t)})),self.addEventListener("sync",(async function(e){if(e.tag)if(e.tag===t.TOPIC_SYNC_TAG)e.waitUntil(async function(){await q.syncTopics()}());else console.log(`"${e.tag}" command is not implemented yet`)})),self.addEventListener("message",(async function(t){console.log("didReceiveMessageListener data: ",t.data)}))})(),{}})()));